A version that has been refactored from the original program code.
